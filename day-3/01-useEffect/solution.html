<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0"
    />
    <title>Solution 1: useEffect Hook</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 20px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>

    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.development.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
      const mockHeroes = [
        {
          id: 1,
          name: 'Iron Man',
          team: 'Avengers',
          power: 'Technology',
        },
        {
          id: 2,
          name: 'Spider-Man',
          team: 'Avengers',
          power: 'Spider abilities',
        },
        {
          id: 3,
          name: 'Wonder Woman',
          team: 'Justice League',
          power: 'Super strength',
        },
        {
          id: 4,
          name: 'Batman',
          team: 'Justice League',
          power: 'Intellect',
        },
      ];

      // EXERCISE 1: Document Title Update
      function TitleUpdater() {
        const [count, setCount] = React.useState(0);

        // Update document title when count changes
        React.useEffect(() => {
          document.title = `Count: ${count}`;
          console.log('Title updated to:', count);
        }, [count]); // Only run when count changes

        const buttonStyle = {
          padding: '10px 20px',
          margin: '5px',
          fontSize: '16px',
          backgroundColor: '#fff',
          color: '#667eea',
          border: 'none',
          borderRadius: '8px',
          cursor: 'pointer',
          fontWeight: 'bold',
        };

        return (
          <div
            style={{
              backgroundColor: 'rgba(255, 255, 255, 0.1)',
              padding: '30px',
              borderRadius: '12px',
              marginBottom: '20px',
              backdropFilter: 'blur(10px)',
              border: '1px solid rgba(255, 255, 255, 0.2)',
            }}
          >
            <h2 style={{ color: 'white', marginTop: '0' }}>
              üìÑ Document Title Updater
            </h2>
            <p style={{ color: 'white', fontSize: '24px' }}>
              Count: {count}
            </p>
            <p
              style={{
                color: 'rgba(255, 255, 255, 0.7)',
                fontSize: '14px',
              }}
            >
              Check the browser tab title!
            </p>
            <button
              style={buttonStyle}
              onClick={() => setCount(count + 1)}
            >
              Increment
            </button>
            <button
              style={buttonStyle}
              onClick={() => setCount(count - 1)}
            >
              Decrement
            </button>
            <button style={buttonStyle} onClick={() => setCount(0)}>
              Reset
            </button>
          </div>
        );
      }

      // EXERCISE 2: Timer with Cleanup
      function Timer() {
        const [seconds, setSeconds] = React.useState(0);
        const [isRunning, setIsRunning] = React.useState(true);

        React.useEffect(() => {
          console.log('Timer effect started');

          if (!isRunning) return;

          const intervalId = setInterval(() => {
            setSeconds((prev) => prev + 1);
          }, 1000);

          // Cleanup function - runs when component unmounts or before effect re-runs
          return () => {
            console.log('Cleaning up timer');
            clearInterval(intervalId);
          };
        }, [isRunning]); // Re-run when isRunning changes

        const buttonStyle = {
          padding: '10px 20px',
          margin: '5px',
          fontSize: '16px',
          backgroundColor: '#fff',
          color: '#667eea',
          border: 'none',
          borderRadius: '8px',
          cursor: 'pointer',
          fontWeight: 'bold',
        };

        return (
          <div
            style={{
              backgroundColor: 'rgba(255, 255, 255, 0.1)',
              padding: '30px',
              borderRadius: '12px',
              marginBottom: '20px',
              backdropFilter: 'blur(10px)',
              border: '1px solid rgba(255, 255, 255, 0.2)',
              textAlign: 'center',
            }}
          >
            <h2 style={{ color: 'white', marginTop: '0' }}>
              ‚è±Ô∏è Timer with Cleanup
            </h2>
            <p
              style={{
                color: 'white',
                fontSize: '48px',
                fontWeight: 'bold',
                margin: '20px 0',
              }}
            >
              {seconds}s
            </p>
            <button
              style={buttonStyle}
              onClick={() => setIsRunning(!isRunning)}
            >
              {isRunning ? '‚è∏ Pause' : '‚ñ∂Ô∏è Resume'}
            </button>
            <button
              style={buttonStyle}
              onClick={() => {
                setSeconds(0);
                setIsRunning(true);
              }}
            >
              üîÑ Reset
            </button>
          </div>
        );
      }

      // EXERCISE 3: Simulated Data Fetching with Loading State
      function HeroLoader() {
        const [heroes, setHeroes] = React.useState([]);
        const [loading, setLoading] = React.useState(true);
        const [error, setError] = React.useState(null);

        React.useEffect(() => {
          console.log('Fetching heroes...');
          setLoading(true);

          // Simulate API call with setTimeout
          const timeoutId = setTimeout(() => {
            try {
              // Simulate successful API response
              setHeroes(mockHeroes);
              setLoading(false);
              console.log('Heroes loaded successfully');
            } catch (err) {
              setError(err.message);
              setLoading(false);
            }
          }, 2000);

          // Cleanup
          return () => clearTimeout(timeoutId);
        }, []); // Empty array = run once on mount

        if (loading) {
          return (
            <div
              style={{
                backgroundColor: 'rgba(255, 255, 255, 0.1)',
                padding: '60px',
                borderRadius: '12px',
                backdropFilter: 'blur(10px)',
                border: '1px solid rgba(255, 255, 255, 0.2)',
                textAlign: 'center',
              }}
            >
              <div
                style={{
                  border: '4px solid rgba(255, 255, 255, 0.2)',
                  borderTop: '4px solid white',
                  borderRadius: '50%',
                  width: '50px',
                  height: '50px',
                  animation: 'spin 1s linear infinite',
                  margin: '0 auto 20px auto',
                }}
              ></div>
              <p style={{ color: 'white', fontSize: '18px' }}>
                Loading heroes...
              </p>
              <style>{`
              @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
              }
            `}</style>
            </div>
          );
        }

        if (error) {
          return (
            <div
              style={{
                backgroundColor: 'rgba(255, 100, 100, 0.2)',
                padding: '30px',
                borderRadius: '12px',
                border: '1px solid rgba(255, 100, 100, 0.4)',
                textAlign: 'center',
              }}
            >
              <p style={{ color: '#ff6b6b', fontSize: '18px' }}>
                ‚ùå Error: {error}
              </p>
            </div>
          );
        }

        return (
          <div
            style={{
              backgroundColor: 'rgba(255, 255, 255, 0.1)',
              padding: '30px',
              borderRadius: '12px',
              backdropFilter: 'blur(10px)',
              border: '1px solid rgba(255, 255, 255, 0.2)',
            }}
          >
            <h2 style={{ color: 'white', marginTop: '0' }}>
              ü¶∏ Loaded Heroes ({heroes.length})
            </h2>
            <div style={{ display: 'grid', gap: '10px' }}>
              {heroes.map((hero) => (
                <div
                  key={hero.id}
                  style={{
                    backgroundColor: 'rgba(255, 255, 255, 0.05)',
                    padding: '15px',
                    borderRadius: '8px',
                    border: '1px solid rgba(255, 255, 255, 0.1)',
                  }}
                >
                  <h3
                    style={{
                      color: 'white',
                      margin: '0 0 5px 0',
                      fontSize: '18px',
                    }}
                  >
                    {hero.name}
                  </h3>
                  <p
                    style={{
                      color: 'rgba(255, 255, 255, 0.7)',
                      margin: '0',
                      fontSize: '14px',
                    }}
                  >
                    Team: {hero.team} | Power: {hero.power}
                  </p>
                </div>
              ))}
            </div>
          </div>
        );
      }

      // BONUS: Clock Component
      function Clock() {
        const [time, setTime] = React.useState(new Date());

        React.useEffect(() => {
          const intervalId = setInterval(() => {
            setTime(new Date());
          }, 1000);

          return () => clearInterval(intervalId);
        }, []);

        return (
          <div
            style={{
              backgroundColor: 'rgba(255, 255, 255, 0.1)',
              padding: '20px',
              borderRadius: '12px',
              textAlign: 'center',
              marginBottom: '20px',
              backdropFilter: 'blur(10px)',
              border: '1px solid rgba(255, 255, 255, 0.2)',
            }}
          >
            <h2 style={{ color: 'white', marginTop: '0' }}>
              üïê Current Time
            </h2>
            <p
              style={{
                color: 'white',
                fontSize: '32px',
                fontWeight: 'bold',
                margin: '10px 0',
              }}
            >
              {time.toLocaleTimeString()}
            </p>
          </div>
        );
      }

      function App() {
        const [showTimer, setShowTimer] = React.useState(true);

        return (
          <div
            style={{
              maxWidth: '900px',
              margin: '0 auto',
              padding: '20px',
            }}
          >
            <h1
              style={{
                color: 'white',
                textAlign: 'center',
                fontSize: '48px',
                marginBottom: '40px',
                textShadow: '0 2px 10px rgba(0, 0, 0, 0.3)',
              }}
            >
              useEffect Hook Examples
            </h1>

            <Clock />
            <TitleUpdater />

            <button
              onClick={() => setShowTimer(!showTimer)}
              style={{
                padding: '10px 20px',
                marginBottom: '20px',
                fontSize: '16px',
                backgroundColor: '#fff',
                color: '#667eea',
                border: 'none',
                borderRadius: '8px',
                cursor: 'pointer',
                fontWeight: 'bold',
                display: 'block',
                margin: '0 auto 20px auto',
              }}
            >
              {showTimer ? 'Hide Timer (test cleanup)' : 'Show Timer'}
            </button>

            {showTimer && <Timer />}
            <HeroLoader />
          </div>
        );
      }

      const rootElement = document.getElementById('root');
      const root = ReactDOM.createRoot(rootElement);
      root.render(<App />);

      // Key Takeaways:
      // 1. useEffect runs AFTER render
      // 2. Dependencies array controls when effect runs
      // 3. Return a cleanup function for subscriptions/timers
      // 4. Empty array [] = run once on mount
      // 5. No array = run on every render (usually avoid)
      // 6. [dep] = run when dep changes
    </script>
  </body>
</html>
